# Claude Key Portal - 页面层级与功能模块规划

## 一、整体页面架构

### 1.1 页面树状结构

```
Claude Key Portal
│
├── 🔓 未认证页面 (Public Pages)
│   ├── /login                    # 登录页
│   ├── /register                 # 注册页
│   └── /forgot-password          # 忘记密码页
│
└── 🔐 已认证页面 (Protected Pages)
    ├── /                         # 仪表板（首页）
    ├── /keys                     # 密钥管理
    │   ├── /keys                 # 密钥列表
    │   ├── /keys/new             # 创建密钥
    │   ├── /keys/[id]            # 密钥详情
    │   └── /keys/[id]/edit       # 编辑密钥
    ├── /usage                    # 使用统计
    │   ├── /usage                # 统计概览
    │   ├── /usage/logs           # 调用日志
    │   └── /usage/export         # 数据导出
    ├── /install                  # 安装指导
    │   ├── /install              # 平台选择
    │   └── /install/[platform]   # 具体平台指导
    └── /settings                 # 设置
        ├── /settings/profile     # 个人信息
        ├── /settings/security    # 安全设置
        └── /settings/preferences # 偏好设置
```

### 1.2 页面层级关系图

```
┌─────────────────────────────────────────────────────────────┐
│                      Layout (Root)                          │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              Navigation / Header                     │   │
│  └─────────────────────────────────────────────────────┘   │
│  ┌─────────────┬───────────────────────────────────────┐   │
│  │             │                                        │   │
│  │   Sidebar   │         Page Content                  │   │
│  │             │                                        │   │
│  │  - 仪表板   │  ┌──────────────────────────────┐     │   │
│  │  - 密钥管理 │  │                              │     │   │
│  │  - 使用统计 │  │      Dynamic Page Content    │     │   │
│  │  - 安装指导 │  │                              │     │   │
│  │  - 设置     │  └──────────────────────────────┘     │   │
│  │             │                                        │   │
│  └─────────────┴───────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    Footer                            │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## 二、页面详细规划

### 📄 Page 1: 登录页 `/login`

#### 层级位置
```
Root
└── (auth)
    └── login
        └── page.tsx
```

#### 功能模块

**1. 登录表单模块**
```tsx
组件: LoginForm
功能:
- 账号输入（邮箱/手机号）
- 密码输入（显示/隐藏切换）
- 记住登录（7天免登录）
- 登录按钮
- 错误提示显示
```

**2. 快捷登录模块**
```tsx
组件: QuickLogin
功能:
- 验证码登录切换
- 第三方登录（预留）
```

**3. 导航模块**
```tsx
组件: AuthNavigation
功能:
- 跳转注册页
- 跳转忘记密码
```

#### 页面布局
```
┌──────────────────────────────────────────────┐
│                   Logo                        │
│                                              │
│  ┌────────────────────────────────────┐     │
│  │     登录到 Claude Key Portal       │     │
│  │                                    │     │
│  │  [账号输入框]                       │     │
│  │  [密码输入框]  [显示/隐藏]          │     │
│  │  □ 记住我                          │     │
│  │                                    │     │
│  │  [登录按钮]                         │     │
│  │                                    │     │
│  │  ────────── 或 ──────────          │     │
│  │  [验证码登录]                       │     │
│  │                                    │     │
│  │  还没有账号? [注册]                 │     │
│  │  [忘记密码?]                       │     │
│  └────────────────────────────────────┘     │
└──────────────────────────────────────────────┘
```

#### 交互流程
1. 用户输入账号密码 → 点击登录
2. 前端验证 → 调用API `/api/v1/auth/login`
3. 成功 → 保存Token → 跳转仪表板
4. 失败 → 显示错误提示

---

### 📄 Page 2: 注册页 `/register`

#### 层级位置
```
Root
└── (auth)
    └── register
        └── page.tsx
```

#### 功能模块

**1. 注册表单模块**
```tsx
组件: RegisterForm
功能:
- 邮箱/手机号输入
- 验证码输入
- 密码输入（强度指示器）
- 确认密码
- 邀请码（可选）
- 同意服务条款
```

**2. 验证码模块**
```tsx
组件: VerificationCode
功能:
- 发送验证码按钮
- 倒计时显示（60秒）
- 重新发送
```

**3. 密码强度模块**
```tsx
组件: PasswordStrength
功能:
- 实时密码强度检测
- 弱/中/强提示
- 密码要求说明
```

#### 页面布局
```
┌──────────────────────────────────────────────┐
│                   Logo                        │
│                                              │
│  ┌────────────────────────────────────┐     │
│  │     创建 Claude Key Portal 账号    │     │
│  │                                    │     │
│  │  [邮箱输入框]                       │     │
│  │  [验证码输入] [发送验证码(60s)]     │     │
│  │  [密码输入框]                       │     │
│  │  ████░░░░ 强度: 中等                │     │
│  │  [确认密码]                         │     │
│  │  [邀请码(可选)]                     │     │
│  │                                    │     │
│  │  ☑ 我已阅读并同意 [服务条款]        │     │
│  │                                    │     │
│  │  [注册按钮]                         │     │
│  │                                    │     │
│  │  已有账号? [登录]                   │     │
│  └────────────────────────────────────┘     │
└──────────────────────────────────────────────┘
```

---

### 📄 Page 3: 仪表板（首页）`/`

#### 层级位置
```
Root
└── (dashboard)
    └── page.tsx
```

#### 功能模块

**1. 概览卡片模块**
```tsx
组件: OverviewCards
功能:
- 总密钥数卡片（数值 + 变化趋势）
- 今日调用卡片（数值 + 环比）
- 今日Token卡片（数值 + 环比）
- 错误率卡片（百分比 + 状态）
数据来源: GET /api/v1/dashboard
刷新频率: 30秒自动刷新
```

**2. 实时指标模块**
```tsx
组件: RealtimeMetrics
功能:
- RPM（每分钟请求数）
- TPM（每分钟Token数）
- 平均延迟
- 实时状态指示灯
数据来源: WebSocket实时推送（或轮询）
```

**3. 调用趋势图模块**
```tsx
组件: CallsTrendChart
功能:
- 折线图显示调用趋势
- 时间范围选择（今天/7天/30天）
- 调用数/错误数双曲线
- 鼠标悬停显示详细数据
图表库: Recharts
```

**4. 模型分布模块**
```tsx
组件: ModelDistributionChart
功能:
- 饼图显示模型使用占比
- 模型列表（名称+百分比+调用数）
- 点击跳转到具体模型统计
```

**5. Top密钥模块**
```tsx
组件: TopKeysTable
功能:
- 表格显示调用量最高的5个密钥
- 密钥名称、今日调用、Token数
- 点击跳转到密钥详情
```

**6. 快捷操作模块**
```tsx
组件: QuickActions
功能:
- [创建密钥] 按钮
- [查看日志] 按钮
- [生成安装脚本] 按钮
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  仪表板                                    [刷新] [设置]    │
├────────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │
│  │总密钥数   │ │今日调用   │ │今日Token │ │错误率     │     │
│  │  8       │ │  1,542   │ │ 154.2K  │ │  0.5%    │     │
│  │  ↑ 2     │ │  ↑ 16.8% │ │ ↑ 12.3% │ │  ✓ 正常   │     │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘     │
│                                                            │
│  ┌────────────────────────┐ ┌────────────────────────┐   │
│  │  实时指标              │ │  快捷操作              │   │
│  │  RPM: 45              │ │  [+ 创建密钥]          │   │
│  │  TPM: 4,500           │ │  [📊 查看日志]         │   │
│  │  延迟: 234ms          │ │  [⚙️ 生成脚本]         │   │
│  │  ● 运行正常           │ └────────────────────────┘   │
│  └────────────────────────┘                              │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  调用趋势  [今天] [7天] [30天]                     │   │
│  │                                                    │   │
│  │  1500 │     ╱╲                                    │   │
│  │       │    ╱  ╲    ╱╲                            │   │
│  │  1000 │   ╱    ╲  ╱  ╲                           │   │
│  │       │  ╱      ╲╱    ╲                          │   │
│  │   500 │ ╱              ╲                         │   │
│  │       └─────────────────────────                 │   │
│  │         9:00  12:00  15:00  18:00                │   │
│  └───────────────────────────────────────────────────┘   │
│                                                            │
│  ┌──────────────────────┐ ┌──────────────────────────┐   │
│  │  模型分布             │ │  Top 5 密钥              │   │
│  │                      │ │  1. Production Key  1.2K │   │
│  │      ⬤ Sonnet 45%   │ │  2. Dev Key         892  │   │
│  │      ⬤ Haiku  35%   │ │  3. Test Key        654  │   │
│  │      ⬤ Opus   20%   │ │  4. Staging Key     432  │   │
│  └──────────────────────┘ │  5. Backup Key      289  │   │
│                           └──────────────────────────┘   │
└────────────────────────────────────────────────────────────┘
```

#### 数据刷新策略
- 概览卡片：30秒自动刷新
- 实时指标：5秒轮询或WebSocket
- 图表数据：用户切换时间范围时刷新
- 手动刷新按钮：清除缓存重新加载

---

### 📄 Page 4: 密钥列表页 `/keys`

#### 层级位置
```
Root
└── (dashboard)
    └── keys
        └── page.tsx
```

#### 功能模块

**1. 顶部操作栏模块**
```tsx
组件: KeysToolbar
功能:
- [+ 创建密钥] 按钮（主要操作）
- [批量操作] 下拉菜单（启用/禁用/删除）
- 搜索框（搜索名称/描述）
- [刷新] 按钮
```

**2. 筛选模块**
```tsx
组件: KeysFilter
功能:
- 状态筛选（全部/活跃/禁用/过期）
- 标签筛选（多选）
- 时间范围（创建时间/最后使用）
- [重置筛选] 按钮
```

**3. 密钥表格模块**
```tsx
组件: KeysTable
功能:
- 列：[选择] [名称] [密钥] [状态] [标签] [今日调用] [总调用] [最后使用] [操作]
- 排序：点击列头排序
- 选择：多选框批量选择
- 操作：[查看] [编辑] [复制] [删除]
- 行点击：跳转详情页
数据来源: GET /api/v1/keys
分页: 20条/页
```

**4. 密钥卡片模块（移动端）**
```tsx
组件: KeyCard
功能:
- 密钥名称和图标
- 状态指示器
- 今日调用数
- 快捷操作按钮
布局: 网格布局（响应式）
```

**5. 分页模块**
```tsx
组件: Pagination
功能:
- 上一页/下一页
- 页码跳转
- 每页数量选择（20/50/100）
- 总记录数显示
```

**6. 空状态模块**
```tsx
组件: EmptyState
功能:
- 无密钥时显示引导
- [创建第一个密钥] 按钮
- 快速开始提示
```

#### 页面布局（桌面端）
```
┌────────────────────────────────────────────────────────────┐
│  密钥管理                                                   │
├────────────────────────────────────────────────────────────┤
│  [+ 创建密钥] [批量操作▼] [刷新]    [搜索框...............] │
│                                                            │
│  筛选: [全部▼] [标签▼] [时间范围▼]            [重置]      │
├────────────────────────────────────────────────────────────┤
│  □  名称          密钥         状态    标签   今日  操作   │
│  ──────────────────────────────────────────────────────── │
│  □  Production   cr_abc...    ● 活跃  prod   1.2K  [...]  │
│  □  Dev Key      cr_def...    ● 活跃  dev    892   [...]  │
│  □  Test Key     cr_ghi...    ○ 禁用  test   0     [...]  │
│  □  Staging      cr_jkl...    ● 活跃  stage  432   [...]  │
│  □  Backup       cr_mno...    ⚠ 过期  -      0     [...]  │
├────────────────────────────────────────────────────────────┤
│  显示 1-5 条，共 5 条      [<] 1 / 1 [>]  [每页20条▼]    │
└────────────────────────────────────────────────────────────┘
```

#### 交互流程
1. **创建密钥**: 点击"创建密钥" → 打开创建表单Modal → 填写信息 → 提交 → 刷新列表
2. **查看详情**: 点击密钥行 → 跳转到 `/keys/[id]`
3. **批量操作**: 选择多个密钥 → 批量操作下拉 → 选择操作 → 确认 → 刷新列表
4. **搜索**: 输入关键词 → 实时过滤（debounce 500ms）
5. **筛选**: 选择筛选条件 → 立即应用 → 更新表格

---

### 📄 Page 5: 创建密钥页 `/keys/new`

#### 层级位置
```
Root
└── (dashboard)
    └── keys
        └── new
            └── page.tsx
```

#### 功能模块

**1. 基本信息模块**
```tsx
组件: BasicInfoForm
功能:
- 密钥名称（必填）
- 描述（可选）
- 标签（多选/自定义）
- 图标上传（可选）
```

**2. 限制配置模块**
```tsx
组件: LimitsConfiguration
功能:
- Token限制（单选：不限制/自定义）
- 并发限制（数字输入）
- 速率限制（请求数/时间窗口）
- 日配额（请求数）
- 月配额（请求数）
```

**3. 模型限制模块**
```tsx
组件: ModelRestriction
功能:
- 启用模型限制开关
- 允许的模型列表（多选）
  - Claude 3.5 Sonnet
  - Claude 3 Opus
  - Claude 3 Haiku
  - Gemini系列
  - GPT系列
```

**4. 高级设置模块**
```tsx
组件: AdvancedSettings
功能:
- IP白名单（逗号分隔）
- Referer白名单
- 客户端限制
- 过期时间设置
  - 固定时间过期
  - 激活后X天过期
```

**5. 预览模块**
```tsx
组件: ConfigPreview
功能:
- 实时显示配置预览
- 配置摘要
- 预估费用（如适用）
```

**6. 操作按钮模块**
```tsx
组件: FormActions
功能:
- [取消] 按钮
- [保存草稿] 按钮（可选）
- [创建密钥] 按钮（主操作）
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  ← 返回密钥列表                     创建API密钥             │
├────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────┐  ┌──────────────────────┐    │
│  │  基本信息               │  │  配置预览             │    │
│  │                         │  │                      │    │
│  │  * 密钥名称             │  │  名称: Production Key│    │
│  │  [输入框.............]  │  │  限制:               │    │
│  │                         │  │  - Token: 不限制     │    │
│  │  描述                   │  │  - 并发: 5          │    │
│  │  [多行文本框........]   │  │  - 速率: 60/分钟    │    │
│  │  [...............]      │  │                      │    │
│  │                         │  │  模型:               │    │
│  │  标签                   │  │  - Sonnet ✓         │    │
│  │  [prod] [api] [+ 添加]  │  │  - Haiku ✓          │    │
│  │                         │  │                      │    │
│  ├─────────────────────────┤  │  预估费用: --       │    │
│  │  限制配置               │  └──────────────────────┘    │
│  │                         │                             │
│  │  Token限制              │                             │
│  │  ○ 不限制 ● 自定义      │                             │
│  │  [1000000] tokens       │                             │
│  │                         │                             │
│  │  并发限制               │                             │
│  │  [5] 个并发请求         │                             │
│  │                         │                             │
│  │  速率限制               │                             │
│  │  [60] 请求 / [1] 分钟   │                             │
│  │                         │                             │
│  ├─────────────────────────┤                             │
│  │  模型限制               │                             │
│  │                         │                             │
│  │  ☑ 启用模型限制         │                             │
│  │  ☑ Claude 3.5 Sonnet    │                             │
│  │  ☑ Claude 3 Haiku       │                             │
│  │  □ Claude 3 Opus        │                             │
│  │  □ Gemini 1.5 Pro       │                             │
│  │                         │                             │
│  ├─────────────────────────┤                             │
│  │  高级设置 [展开▼]       │                             │
│  │                         │                             │
│  └─────────────────────────┘                             │
│                                                            │
│            [取消]  [保存草稿]  [创建密钥]                  │
└────────────────────────────────────────────────────────────┘
```

#### 表单验证规则
- 密钥名称：必填，2-50字符
- Token限制：正整数
- 并发限制：1-100
- 速率限制：1-1000请求，1-60分钟
- 模型：至少选择一个（如启用限制）

#### 交互流程
1. 用户填写表单 → 实时验证 → 更新预览
2. 点击"创建密钥" → 前端验证 → 调用API
3. 创建成功 → 显示完整密钥（仅一次）→ Modal提示保存
4. 用户确认 → 跳转到密钥列表

---

### 📄 Page 6: 密钥详情页 `/keys/[id]`

#### 层级位置
```
Root
└── (dashboard)
    └── keys
        └── [id]
            └── page.tsx
```

#### 功能模块

**1. 密钥信息卡片模块**
```tsx
组件: KeyInfoCard
功能:
- 密钥名称和状态指示器
- 创建时间、最后使用时间
- 密钥值（部分显示 + 复制按钮）
- 标签列表
- 快捷操作：[编辑] [重新生成] [删除]
```

**2. 使用概览模块**
```tsx
组件: UsageOverview
功能:
- 4个统计卡片
  - 总调用次数
  - 今日调用
  - 总Token数
  - 总费用
数据来源: GET /api/v1/keys/:id
```

**3. 使用趋势图模块**
```tsx
组件: KeyUsageTrend
功能:
- 时间范围选择（7天/30天/90天）
- 折线图：调用数趋势
- 柱状图：Token消耗趋势
- 数据表格导出
```

**4. 模型使用分布模块**
```tsx
组件: ModelUsageDistribution
功能:
- 饼图：模型调用占比
- 表格：
  - 模型名称
  - 调用次数
  - Token数
  - 百分比
```

**5. 最近调用日志模块**
```tsx
组件: RecentCallLogs
功能:
- 表格显示最近50次调用
- 列：时间、模型、Token、耗时、状态
- [查看全部日志] 链接
- 实时更新（可选）
```

**6. 配置信息模块**
```tsx
组件: KeyConfiguration
功能:
- 限制配置显示
  - Token限制及使用进度条
  - 并发限制
  - 速率限制
- 模型限制列表
- 高级设置（IP白名单等）
```

**7. 操作历史模块**
```tsx
组件: KeyHistory
功能:
- 时间线显示操作历史
  - 创建
  - 更新配置
  - 禁用/启用
  - 重新生成
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  ← 返回列表              Production Key                     │
├────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────┐ │
│  │  ● 活跃  Production Key                 [编辑] [删除] │ │
│  │  密钥: cr_abc***xyz [复制]                            │ │
│  │  创建: 2025-01-01  最后使用: 2分钟前                  │ │
│  │  标签: [prod] [api]                                   │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐         │
│  │总调用    │ │今日调用  │ │总Token  │ │总费用    │         │
│  │15,420   │ │1,542    │ │1.54M    │ │$154.20  │         │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘         │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  使用趋势  [7天] [30天] [90天]           [导出]   │   │
│  │                                                    │   │
│  │  2000 │     ╱╲                                    │   │
│  │       │    ╱  ╲    ╱╲                            │   │
│  │  1000 │   ╱    ╲  ╱  ╲                           │   │
│  │       │  ╱      ╲╱    ╲                          │   │
│  │     0 │ ╱              ╲                         │   │
│  │       └─────────────────────────                 │   │
│  └───────────────────────────────────────────────────┘   │
│                                                            │
│  ┌──────────────────────┐ ┌──────────────────────────┐   │
│  │  模型使用分布         │ │  最近调用日志              │   │
│  │                      │ │  12:34  Sonnet  1.2K 234ms│   │
│  │    ⬤ Sonnet  60%    │ │  12:33  Haiku   0.8K 156ms│   │
│  │    ⬤ Haiku   30%    │ │  12:32  Sonnet  2.1K 345ms│   │
│  │    ⬤ Opus    10%    │ │  ...                       │   │
│  │                      │ │  [查看全部日志]            │   │
│  └──────────────────────┘ └──────────────────────────┘   │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  配置信息                             [编辑配置]   │   │
│  │                                                    │   │
│  │  Token限制: 1,000,000                             │   │
│  │  ████████░░  80% 已使用 (800,000/1,000,000)      │   │
│  │                                                    │   │
│  │  并发限制: 5 个并发请求                            │   │
│  │  速率限制: 60 请求/分钟                            │   │
│  │                                                    │   │
│  │  允许的模型:                                       │   │
│  │  • Claude 3.5 Sonnet                              │   │
│  │  • Claude 3 Haiku                                 │   │
│  └───────────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────────────┘
```

#### 数据加载策略
- 初始加载：并行请求密钥详情、使用统计、最近日志
- 图表数据：按需加载（切换时间范围时）
- 最近日志：30秒自动刷新
- 配置信息：从密钥详情中获取

---

### 📄 Page 7: 使用统计页 `/usage`

#### 层级位置
```
Root
└── (dashboard)
    └── usage
        └── page.tsx
```

#### 功能模块

**1. 时间范围选择模块**
```tsx
组件: TimeRangeSelector
功能:
- 预设范围（今天/昨天/7天/30天/本月）
- 自定义范围选择器
- 对比功能（对比上周期）
```

**2. 总览指标模块**
```tsx
组件: UsageOverviewMetrics
功能:
- 6个关键指标卡片
  - 总调用次数（+ 变化）
  - 总Token数（+ 变化）
  - 总费用（+ 变化）
  - 平均延迟
  - 成功率
  - 错误率
```

**3. 调用趋势模块**
```tsx
组件: DetailedCallsTrend
功能:
- 多维度折线图
  - 调用数
  - Token数
  - 费用
- 粒度选择（小时/天/周/月）
- 图例切换
- 数据点悬停详情
```

**4. 模型使用统计模块**
```tsx
组件: ModelUsageStats
功能:
- 表格显示各模型统计
- 列：模型、调用次数、Token数、平均Token、费用、占比
- 排序功能
- 导出功能
```

**5. 密钥使用排行模块**
```tsx
组件: KeyUsageRanking
功能:
- 横向柱状图
- Top 10 密钥使用量
- 点击跳转到密钥详情
```

**6. 错误分析模块**
```tsx
组件: ErrorAnalysis
功能:
- 错误类型分布饼图
- 错误列表（错误码、次数、占比）
- 错误趋势折线图
```

**7. 数据导出模块**
```tsx
组件: DataExport
功能:
- 导出格式选择（CSV/JSON/Excel）
- 导出范围选择
- [导出] 按钮
- 导出历史列表
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  使用统计                                                   │
├────────────────────────────────────────────────────────────┤
│  [今天▼] [7天] [30天] [自定义]    ☑ 对比上周期  [导出]    │
│                                                            │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ │
│  │总调用   │ │总Token │ │总费用   │ │平均延迟 │ │成功率  │ │
│  │15.4K   │ │1.54M   │ │$154.20 │ │234ms   │ │99.5%  │ │
│  │↑ 16.8% │ │↑ 12.3% │ │↑ 10.5% │ │↓ 5.2%  │ │↑ 0.3% │ │
│  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘ │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  调用趋势  [调用数] [Token数] [费用]  [小时▼]    │   │
│  │                                                    │   │
│  │  2000 │     ╱╲                                    │   │
│  │       │    ╱  ╲    ╱╲                            │   │
│  │  1000 │   ╱    ╲  ╱  ╲                           │   │
│  │       │  ╱      ╲╱    ╲                          │   │
│  │     0 │ ╱              ╲                         │   │
│  │       └─────────────────────────                 │   │
│  └───────────────────────────────────────────────────┘   │
│                                                            │
│  ┌──────────────────────────────────────────────────┐    │
│  │  模型使用统计                          [导出]     │    │
│  │  ──────────────────────────────────────────────  │    │
│  │  模型            调用    Token    费用    占比   │    │
│  │  Sonnet 3.5     9,240   924K    $92.40   60%    │    │
│  │  Haiku 3        4,620   462K    $46.20   30%    │    │
│  │  Opus 3         1,540   154K    $15.40   10%    │    │
│  └──────────────────────────────────────────────────┘    │
│                                                            │
│  ┌──────────────────────┐ ┌──────────────────────────┐   │
│  │  密钥使用排行         │ │  错误分析                 │   │
│  │                      │ │                          │   │
│  │  Production  ▓▓▓▓▓▓ │ │    ⬤ 429: 45%           │   │
│  │  Dev         ▓▓▓▓▓  │ │    ⬤ 500: 30%           │   │
│  │  Test        ▓▓▓    │ │    ⬤ 401: 15%           │   │
│  │  Staging     ▓▓     │ │    ⬤ Other: 10%         │   │
│  └──────────────────────┘ └──────────────────────────┘   │
└────────────────────────────────────────────────────────────┘
```

---

### 📄 Page 8: 调用日志页 `/usage/logs`

#### 层级位置
```
Root
└── (dashboard)
    └── usage
        └── logs
            └── page.tsx
```

#### 功能模块

**1. 日志筛选模块**
```tsx
组件: LogsFilter
功能:
- 时间范围选择
- 密钥筛选（多选）
- 模型筛选（多选）
- 状态码筛选（成功/失败/全部）
- 搜索框（搜索请求内容）
- [重置] 按钮
```

**2. 日志列表模块**
```tsx
组件: LogsList
功能:
- 表格显示日志
- 列：
  - 时间戳
  - 密钥名称
  - 模型
  - 方法/路径
  - 状态码
  - Token（输入/输出）
  - 耗时
  - [详情]
- 分页（50条/页）
- 实时更新开关
数据来源: GET /api/v1/usage/logs
```

**3. 日志详情抽屉模块**
```tsx
组件: LogDetailDrawer
功能:
- 右侧抽屉展开显示日志详情
- 请求信息
  - 时间戳
  - 密钥
  - 客户端IP
  - User-Agent
- 请求详情
  - 模型
  - 参数
  - 提示词（可选）
- 响应详情
  - 状态码
  - Token统计
  - 耗时
  - 响应内容（可选）
- 错误信息（如有）
```

**4. 日志统计模块**
```tsx
组件: LogsStats
功能:
- 当前筛选条件下的统计
  - 总日志数
  - 成功率
  - 平均耗时
  - 总Token数
```

**5. 导出模块**
```tsx
组件: LogsExport
功能:
- 导出当前筛选结果
- 格式选择（CSV/JSON）
- [导出] 按钮
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  调用日志                                   ☐ 实时更新      │
├────────────────────────────────────────────────────────────┤
│  [时间范围▼] [密钥▼] [模型▼] [状态▼]  [搜索.....] [导出]  │
│                                                            │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐            │
│  │总日志   │ │成功率   │ │平均耗时 │ │总Token │            │
│  │15,420  │ │99.5%   │ │234ms   │ │1.54M   │            │
│  └────────┘ └────────┘ └────────┘ └────────┘            │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  时间          密钥      模型    状态  Token  耗时  │   │
│  │  ────────────────────────────────────────────────│   │
│  │  12:34:56  Production  Sonnet  200   1.2K  234ms │   │
│  │  12:34:55  Dev         Haiku   200   0.8K  156ms │   │
│  │  12:34:54  Production  Sonnet  429   0     0ms   │   │
│  │  12:34:53  Test        Haiku   200   0.6K  189ms │   │
│  │  12:34:52  Production  Sonnet  200   2.1K  345ms │   │
│  │  12:34:51  Staging     Haiku   500   0     0ms   │   │
│  │  12:34:50  Production  Sonnet  200   1.5K  267ms │   │
│  │  ...                                              │   │
│  └───────────────────────────────────────────────────┘   │
│                                                            │
│  [<] 1 / 308 [>]  [每页50条▼]                            │
└────────────────────────────────────────────────────────────┘
```

---

### 📄 Page 9: 安装指导页 `/install`

#### 层级位置
```
Root
└── (dashboard)
    └── install
        └── page.tsx
```

#### 功能模块

**1. 平台选择模块**
```tsx
组件: PlatformSelector
功能:
- 三个平台卡片（macOS/Linux/Windows）
- 自动检测当前平台并高亮
- 点击切换平台
```

**2. 密钥选择模块**
```tsx
组件: KeySelector
功能:
- 下拉选择要使用的密钥
- 显示密钥名称和状态
- [创建新密钥] 快捷链接
```

**3. 环境选择模块**
```tsx
组件: EnvironmentSelector
功能:
- 单选：Claude Code / Continue / Cursor / Custom
- 显示环境说明
```

**4. 选项配置模块**
```tsx
组件: InstallOptions
功能:
- ☐ 使用代理
  - 代理URL输入
- ☐ 自定义安装路径
  - 路径输入
- ☐ 自动启动
```

**5. 脚本生成模块**
```tsx
组件: ScriptGenerator
功能:
- [生成安装脚本] 按钮
- 显示生成的脚本
- 代码高亮显示
- [复制脚本] 按钮
- [下载脚本] 按钮
```

**6. 执行步骤模块**
```tsx
组件: InstallationSteps
功能:
- 步骤列表（1-3步）
- 每步的详细说明
- 截图示例（可选）
- [测试连接] 按钮
```

**7. 环境检测模块**
```tsx
组件: EnvironmentCheck
功能:
- 检测必需工具（Node.js/Python等）
- 显示检测结果（✓/✗）
- 安装建议
```

**8. 常见问题模块**
```tsx
组件: FAQ
功能:
- 折叠面板显示常见问题
- 问题和解答
- [查看完整文档] 链接
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  安装指导                                                   │
├────────────────────────────────────────────────────────────┤
│  步骤 1: 选择平台                                           │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐                   │
│  │  🍎      │ │  🐧      │ │  🪟      │                   │
│  │  macOS   │ │  Linux   │ │ Windows  │                   │
│  │  ● 已选择│ │          │ │          │                   │
│  └──────────┘ └──────────┘ └──────────┘                   │
│                                                            │
│  步骤 2: 选择密钥和环境                                     │
│  使用密钥: [Production Key ▼]         [+ 创建新密钥]       │
│  环境:     ● Claude Code  ○ Continue  ○ Cursor  ○ Custom  │
│                                                            │
│  步骤 3: 配置选项（可选）                                   │
│  ☐ 使用代理  [http://proxy.example.com:8080]              │
│  ☐ 自定义安装路径  [/usr/local/bin]                        │
│  ☐ 自动启动                                                │
│                                                            │
│  [生成安装脚本]                                            │
│                                                            │
│  ┌───────────────────────────────────────────────────┐   │
│  │  安装脚本                         [复制] [下载]   │   │
│  │  ─────────────────────────────────────────────── │   │
│  │  #!/bin/bash                                      │   │
│  │                                                    │   │
│  │  # Claude Key Portal Installation Script          │   │
│  │  # Platform: macOS                                │   │
│  │  # Generated: 2025-01-01 12:00:00                 │   │
│  │                                                    │   │
│  │  API_KEY="cr_abc123..."                           │   │
│  │  BASE_URL="https://claude.just-play.fun"          │   │
│  │                                                    │   │
│  │  # Configure Claude Code                          │   │
│  │  mkdir -p ~/.config/claude-code                   │   │
│  │  cat > ~/.config/claude-code/config.json <<EOF   │   │
│  │  {                                                │   │
│  │    "apiKey": "$API_KEY",                          │   │
│  │    "baseURL": "$BASE_URL"                         │   │
│  │  }                                                │   │
│  │  EOF                                              │   │
│  │                                                    │   │
│  │  echo "Installation completed!"                   │   │
│  └───────────────────────────────────────────────────┘   │
│                                                            │
│  执行步骤：                                                │
│  1️⃣ 将上述脚本保存为 install.sh                            │
│  2️⃣ 赋予执行权限: chmod +x install.sh                      │
│  3️⃣ 执行脚本: ./install.sh                                 │
│                                                            │
│  [测试连接]                                                │
│                                                            │
│  环境检测:                                                 │
│  ✓ Node.js 20.x 已安装                                    │
│  ✓ npm 10.x 已安装                                        │
│  ✓ Git 2.x 已安装                                         │
│                                                            │
│  常见问题 FAQ                                              │
│  [▼] 如何更新密钥？                                        │
│  [▶] 连接失败怎么办？                                      │
│  [▶] 如何配置代理？                                        │
└────────────────────────────────────────────────────────────┘
```

---

### 📄 Page 10: 个人设置页 `/settings/profile`

#### 层级位置
```
Root
└── (dashboard)
    └── settings
        └── profile
            └── page.tsx
```

#### 功能模块

**1. 头像模块**
```tsx
组件: AvatarUpload
功能:
- 显示当前头像
- 点击上传新头像
- 拖放上传
- 裁剪功能
```

**2. 基本信息表单模块**
```tsx
组件: ProfileForm
功能:
- 昵称输入
- 邮箱（显示+修改）
- 手机号（显示+修改）
- 个人简介（多行文本）
- [保存更改] 按钮
```

**3. 账号信息模块**
```tsx
组件: AccountInfo
功能:
- 用户ID
- 注册时间
- 最后登录时间
- 邀请码（复制）
```

**4. 偏好设置模块**
```tsx
组件: Preferences
功能:
- 语言选择（中文/English）
- 时区选择
- 主题选择（浅色/深色/自动）
- 日期格式
```

**5. 通知设置模块**
```tsx
组件: NotificationSettings
功能:
- ☐ 邮件通知
- ☐ 密钥状态变更通知
- ☐ 使用量告警通知
- ☐ 系统公告
```

#### 页面布局
```
┌────────────────────────────────────────────────────────────┐
│  设置                                                       │
│  ┌──────────┐  ┌────────────────────────────────────┐     │
│  │ 个人信息  │  │  个人资料                          │     │
│  │ 安全设置  │  │                                    │     │
│  │ 偏好设置  │  │  ┌────────┐                        │     │
│  └──────────┘  │  │  头像   │  [上传新头像]          │     │
│                │  └────────┘                        │     │
│                │                                    │     │
│                │  昵称                              │     │
│                │  [张三.........................]    │     │
│                │                                    │     │
│                │  邮箱                              │     │
│                │  user@example.com  [修改]         │     │
│                │                                    │     │
│                │  手机号                            │     │
│                │  138****1234  [修改]              │     │
│                │                                    │     │
│                │  个人简介                          │     │
│                │  [多行文本框...................]   │     │
│                │  [..............................]  │     │
│                │                                    │     │
│                │  ────────────────────────          │     │
│                │                                    │     │
│                │  账号信息                          │     │
│                │  用户ID: usr_abc123               │     │
│                │  注册时间: 2025-01-01             │     │
│                │  最后登录: 2分钟前                 │     │
│                │  邀请码: INV123 [复制]             │     │
│                │                                    │     │
│                │  ────────────────────────          │     │
│                │                                    │     │
│                │  偏好设置                          │     │
│                │  语言: [中文 ▼]                    │     │
│                │  时区: [Asia/Shanghai ▼]          │     │
│                │  主题: [● 浅色 ○ 深色 ○ 自动]      │     │
│                │                                    │     │
│                │  ────────────────────────          │     │
│                │                                    │     │
│                │  通知设置                          │     │
│                │  ☑ 邮件通知                        │     │
│                │  ☑ 密钥状态变更                    │     │
│                │  ☑ 使用量告警                      │     │
│                │  ☐ 系统公告                        │     │
│                │                                    │     │
│                │            [取消]  [保存更改]      │     │
│                └────────────────────────────────────┘     │
└────────────────────────────────────────────────────────────┘
```

---

## 三、全局组件规划

### 3.1 布局组件

**RootLayout**
```tsx
组件路径: app/layout.tsx
功能:
- HTML文档结构
- 全局样式注入
- 字体加载
- 元数据配置
- Provider包装（QueryClient, Theme）
```

**DashboardLayout**
```tsx
组件路径: app/(dashboard)/layout.tsx
功能:
- 顶部导航栏
- 左侧边栏
- 主内容区
- 面包屑导航
- 用户菜单
```

**AuthLayout**
```tsx
组件路径: app/(auth)/layout.tsx
功能:
- 居中布局
- 背景装饰
- Logo显示
```

### 3.2 导航组件

**Sidebar**
```tsx
组件: components/layout/Sidebar.tsx
功能:
- 导航菜单
  - 🏠 仪表板
  - 🔑 密钥管理
  - 📊 使用统计
  - 📥 安装指导
  - ⚙️ 设置
- 折叠/展开
- 活动状态指示
- 数量徽章（如：密钥数）
```

**Header**
```tsx
组件: components/layout/Header.tsx
功能:
- Logo + 项目名称
- 面包屑导航
- 全局搜索框
- 通知中心（铃铛图标+徽章）
- 用户菜单（头像+下拉）
  - 个人信息
  - 设置
  - 退出登录
```

**Breadcrumb**
```tsx
组件: components/layout/Breadcrumb.tsx
功能:
- 自动根据路由生成面包屑
- 点击跳转
- 当前页高亮
```

### 3.3 通用UI组件

**Button**
```tsx
变体: primary, secondary, ghost, danger
尺寸: sm, md, lg
状态: default, loading, disabled
```

**Input**
```tsx
类型: text, password, email, number
特性: prefix, suffix, clearable, showCount
验证: 实时验证 + 错误提示
```

**Select**
```tsx
特性: 单选/多选
搜索: 支持搜索过滤
分组: 支持选项分组
```

**Modal**
```tsx
用途: 确认对话框、表单弹窗
特性: 可拖动、自定义尺寸
动画: 淡入淡出
```

**Table**
```tsx
特性: 排序、筛选、分页
选择: 单选/多选
固定: 固定列/固定头
导出: 导出数据
```

**Chart**
```tsx
类型: 折线图、柱状图、饼图、面积图
交互: 悬停提示、图例切换、缩放
响应式: 自适应容器大小
```

**Card**
```tsx
用途: 内容容器
特性: 标题、描述、操作按钮
样式: 阴影、边框、圆角
```

**Badge**
```tsx
用途: 状态指示、数量显示
颜色: success, warning, error, info
位置: 独立/附着在其他组件上
```

**Toast**
```tsx
类型: success, error, warning, info
位置: top, bottom, top-right等
持续时间: 可配置
```

**Loading**
```tsx
类型:
- Spinner（小加载图标）
- Skeleton（骨架屏）
- Progress（进度条）
用途: 数据加载中显示
```

### 3.4 业务组件

**KeyStatusBadge**
```tsx
功能: 显示密钥状态
状态: 活跃(绿)、禁用(灰)、过期(红)、即将过期(黄)
```

**UsageProgressBar**
```tsx
功能: 显示使用量进度
显示: 已用/总量、百分比、颜色指示
```

**EmptyState**
```tsx
功能: 无数据时的占位符
内容: 图标、文字、操作按钮
变体: 无密钥、无日志、搜索无结果等
```

**ConfirmDialog**
```tsx
功能: 确认操作对话框
用途: 删除密钥、重新生成等危险操作
显示: 警告图标、操作说明、确认按钮
```

---

## 四、页面交互流程图

### 4.1 用户认证流程

```
┌──────┐
│ 登录 │
└──┬───┘
   │
   ├─→ 输入账号密码
   │
   ├─→ 前端验证
   │   ├─ 失败 → 显示错误
   │   └─ 成功 → 调用API
   │
   ├─→ 后端验证
   │   ├─ 失败 → 显示错误
   │   └─ 成功 → 返回Token
   │
   ├─→ 保存Token到LocalStorage
   │
   └─→ 跳转到仪表板
```

### 4.2 密钥管理流程

```
┌──────────┐
│ 密钥列表 │
└────┬─────┘
     │
     ├─→ [创建密钥]
     │   ├─→ 打开创建表单
     │   ├─→ 填写信息
     │   ├─→ 提交
     │   ├─→ 显示完整密钥（仅一次）
     │   └─→ 返回列表
     │
     ├─→ [查看详情]
     │   ├─→ 加载密钥信息
     │   ├─→ 加载使用统计
     │   └─→ 显示详情页
     │
     ├─→ [编辑]
     │   ├─→ 打开编辑表单
     │   ├─→ 修改信息
     │   ├─→ 提交
     │   └─→ 刷新列表
     │
     └─→ [删除]
         ├─→ 确认对话框
         ├─→ 确认删除
         ├─→ 调用API
         └─→ 刷新列表
```

### 4.3 安装指导流程

```
┌──────────┐
│ 安装指导 │
└────┬─────┘
     │
     ├─→ 选择平台（macOS/Linux/Windows）
     │
     ├─→ 选择密钥
     │
     ├─→ 选择环境（Claude Code/Continue等）
     │
     ├─→ 配置选项（代理、路径等）
     │
     ├─→ 点击"生成脚本"
     │   ├─→ 调用API生成脚本
     │   └─→ 显示脚本内容
     │
     ├─→ [复制脚本] 或 [下载脚本]
     │
     ├─→ 按步骤执行
     │
     └─→ [测试连接]
         ├─→ 调用测试API
         └─→ 显示连接结果
```

---

## 五、响应式设计规范

### 5.1 断点定义

```css
/* 移动端 */
@media (max-width: 640px) { }

/* 平板 */
@media (min-width: 641px) and (max-width: 1024px) { }

/* 桌面 */
@media (min-width: 1025px) { }
```

### 5.2 移动端适配

**侧边栏**
- 移动端: 抽屉式侧边栏，默认隐藏
- 平板: 可折叠侧边栏
- 桌面: 固定侧边栏

**表格**
- 移动端: 卡片列表布局
- 平板: 简化表格（隐藏次要列）
- 桌面: 完整表格

**图表**
- 移动端: 单列布局，简化图例
- 平板: 双列布局
- 桌面: 多列布局

**表单**
- 移动端: 单列布局，大按钮
- 平板: 单列或双列
- 桌面: 多列布局

---

## 六、性能优化策略

### 6.1 代码分割

```tsx
// 路由级代码分割
const KeysPage = lazy(() => import('./pages/KeysPage'));
const UsagePage = lazy(() => import('./pages/UsagePage'));

// 组件级代码分割
const HeavyChart = lazy(() => import('./components/HeavyChart'));
```

### 6.2 图片优化

- 使用Next.js Image组件
- 自动WebP转换
- 响应式图片
- 懒加载

### 6.3 数据加载

- React Query缓存
- Skeleton加载状态
- 分页加载
- 虚拟滚动（长列表）

---

## 七、开发优先级

### Phase 1: 核心功能（第1-2周）
1. ✅ 登录/注册页
2. ✅ 仪表板页
3. ✅ 密钥列表页
4. ✅ 密钥详情页

### Phase 2: 扩展功能（第3周）
5. ✅ 创建/编辑密钥
6. ✅ 使用统计页
7. ✅ 安装指导页

### Phase 3: 完善功能（第4周）
8. ✅ 调用日志页
9. ✅ 个人设置页
10. ✅ 响应式优化
11. ✅ 性能优化

---

更新时间: 2025-01-01
版本: v1.0.0
