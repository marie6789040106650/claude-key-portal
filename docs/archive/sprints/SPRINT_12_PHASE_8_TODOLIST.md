# Sprint 12 - Phase 8: 前后端联调 + UI 优化

**阶段**: 🟢 GREEN (联调) + 🔵 REFACTOR (优化)
**预计时间**: 6-8 小时
**开始时间**: 2025-10-04

## 📋 任务列表

### Task 1: API 集成到前端组件
**预计时间**: 1.5-2 小时
**描述**: 将 API 路由集成到 KeysTable 和 KeyForm 组件

- [ ] 更新 `app/dashboard/keys/page.tsx`
  - [ ] 修改 API 调用以匹配实际响应格式
  - [ ] 处理分页响应格式 `{ keys: [], total, page, limit }`
  - [ ] 处理创建响应格式 `{ key: {...}, warning }`
- [ ] 更新 `components/keys/KeyForm.tsx`
  - [ ] 调整响应数据结构处理
  - [ ] 显示创建成功时的完整密钥值
  - [ ] 处理更新响应格式 `{ key: {...} }`
- [ ] 更新 `components/keys/KeysTable.tsx`
  - [ ] 使用 API 返回的 keyMasked 和 keyPrefix
  - [ ] 处理数字类型的 totalTokens 和 totalCalls
- [ ] 验证所有操作正常工作

### Task 2: 错误处理优化
**预计时间**: 1-1.5 小时
**描述**: 完善前端错误处理和用户提示

- [ ] 统一错误提示格式
- [ ] 添加网络错误友好提示
- [ ] 添加 CRS 服务不可用提示
- [ ] 实现错误重试机制
- [ ] 添加错误日志记录

### Task 3: 加载状态改进
**预计时间**: 1 小时
**描述**: 优化加载状态显示

- [ ] 添加骨架屏组件
- [ ] 优化按钮加载状态
- [ ] 添加全局加载指示器
- [ ] 防止重复提交

### Task 4: 乐观更新实现
**预计时间**: 1.5-2 小时
**描述**: 实现乐观更新提升用户体验

- [ ] 创建密钥时立即更新 UI
- [ ] 更新密钥时立即反映变更
- [ ] 删除密钥时立即从列表移除
- [ ] 操作失败时回滚 UI 状态
- [ ] 使用 React Query 的 optimisticUpdate

### Task 5: UI/UX 优化
**预计时间**: 1-1.5 小时
**描述**: 提升整体用户体验

- [ ] 优化表单验证反馈
- [ ] 改进密钥复制功能（显示完整密钥一次）
- [ ] 添加操作确认对话框动画
- [ ] 优化表格排序和筛选
- [ ] 响应式布局调整

### Task 6: 集成测试
**预计时间**: 1-1.5 小时
**描述**: 端到端测试前后端集成

- [ ] 手动测试所有 CRUD 操作
- [ ] 测试错误场景
- [ ] 测试加载状态
- [ ] 测试乐观更新
- [ ] 验证 CRS 集成（如果可用）

### Task 7: Git 提交并创建 Phase 9 Todolist
**预计时间**: 0.5 小时
**描述**: 提交代码并规划下一阶段

- [ ] 运行所有测试确保通过
- [ ] ESLint 检查
- [ ] Git 提交（描述性消息）
- [ ] 创建 `docs/SPRINT_12_PHASE_9_TODOLIST.md`（如需要）
- [ ] 更新 Sprint 12 进度文档

## ✅ 完成标准

- [ ] API 完全集成到前端
- [ ] 所有 CRUD 操作正常工作
- [ ] 错误处理完善且用户友好
- [ ] 加载状态清晰明确
- [ ] 乐观更新实现并稳定
- [ ] UI/UX 流畅无卡顿
- [ ] 手动测试全部通过

## 📊 预期成果

1. **功能完整性**: 前后端完全打通，所有功能可用
2. **用户体验**: 加载快速，反馈及时，操作流畅
3. **错误处理**: 所有错误都有友好提示和恢复机制
4. **性能表现**: 界面响应时间 < 100ms（本地操作）
5. **代码质量**: 无 ESLint 错误，React 最佳实践

## 🔄 下一阶段预告

**Phase 9** (可选): 高级功能实现
- 批量操作（批量删除、批量导出）
- 密钥使用统计图表集成
- 高级搜索和过滤
- 密钥使用历史记录

**或**

**Sprint 13**: 用户管理功能
- 用户注册/登录流程
- 用户权限管理
- 多用户隔离

---

**创建时间**: 2025-10-04
**状态**: 待开始
